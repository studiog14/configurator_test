<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Test Configuratora</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .pass { background: #d4edda; border-color: #c3e6cb; }
        .fail { background: #f8d7da; border-color: #f5c6cb; }
    </style>
</head>
<body>
    <h1>Test Configuratora</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        function addTest(name, passed, details = '') {
            const div = document.createElement('div');
            div.className = `test ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `
                <strong>${passed ? '✅' : '❌'} ${name}</strong>
                ${details ? `<br><small>${details}</small>` : ''}
            `;
            results.appendChild(div);
        }
        
        // Test 1: Sprawdź dostępność głównego pliku
        fetch('index.html')
            .then(response => {
                addTest('Główny plik dostępny', response.ok, `Status: ${response.status}`);
            })
            .catch(err => {
                addTest('Główny plik dostępny', false, `Błąd: ${err.message}`);
            });
        
        // Test 2: Sprawdź czy ThreePipe się ładuje
        const iframe = document.createElement('iframe');
        iframe.src = 'index.html';
        iframe.style.display = 'none';
        document.body.appendChild(iframe);
        
        setTimeout(() => {
            try {
                const hasErrors = iframe.contentWindow.console?.error || false;
                addTest('ThreePipe loading', !hasErrors, 'Brak błędów w konsoli');
            } catch (e) {
                addTest('ThreePipe loading', false, `Cross-origin error: ${e.message}`);
            }
        }, 3000);
        
        // Test 3: Sprawdź dostępność modeli
        const modelTests = ['chairs/Amy-2.glb', 'legs/Regularne.glb', 'hdr/hamburg_hbf_1k.hdr'];
        modelTests.forEach(model => {
            fetch(model)
                .then(response => {
                    addTest(`Model: ${model}`, response.ok, `Status: ${response.status}`);
                })
                .catch(err => {
                    addTest(`Model: ${model}`, false, `Błąd: ${err.message}`);
                });
        });
        
        // Test 4: Sprawdź dostęp do Google Sheets
        const sheetId = '1vCs6YeHgKqlYwg8rvJOqVzNRnXeATJCBuK-zh3NNj78';
        const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&sheet=Dane&v=${new Date().getTime()}`;
        
        fetch(sheetURL)
            .then(response => {
                addTest('Google Sheets API', response.ok, `Status: ${response.status}`);
                return response.text();
            })
            .then(csvText => {
                const lines = csvText.split('\n').length;
                addTest('Google Sheets Data', lines > 5, `Znaleziono ${lines} linii danych`);
            })
            .catch(err => {
                addTest('Google Sheets API', false, `Błąd: ${err.message}`);
            });
    </script>
</body>
</html>
